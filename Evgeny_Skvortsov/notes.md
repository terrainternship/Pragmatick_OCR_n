Тут будет что-то типа черновика. Мысли вслух.

#### 04.12.2023
Соображения в отсутствие ТЗ:
- Сканирование. Сканируется одним и тем же устройством, предположительно сканером с автоподатчиком.
- Параметры сканирования зафиксированы (формат растрового изображения, размер бумаги, плотность dpi, ч/б или монохром, яркость, контраст и т.д.).
- Игнорируются бюллетени, отсканированные с изнаночной стороны, сложенные пополам, поврежденные, но в статистике учитываются как недействительные.
- Бюллетени, имеющие форму отличную от установленной, определяются как «неустановленной формы».
- Предобработка изображений (ориентация листа, геометрические искажения, шум, кадрирование).
- Разметка изображения (координаты и размеры области для номера бюллетеня, координаты и размеры области для отметок о голосования, либо процесс поиска нужных областей для распознавания на бюллетене автоматизирован).
- Тут уже навыков не достает (можно ли находить, считывать и обрабатывать нейросетью отдельные области на изображении или нужно их вырезать и обрабатывать как отдельные изображения).
- Предобработка результатов распознавания (учесть выход отметок выбора и номера бюллетеня за границы отведенных областей, наличие дублирующих отметок выбора на бюллетене).
- Запись полученных данных в базу (с учетом перевернутых и испорченных бюллетеней).
- Вывод систематизированных результатов голосования из базы на печать в установленной форме и/или передача данных на внешний ресурс по сети (Ethernet, Wi-Fi, Bluetooth, NFC и т.д.) или вывод на внешний носитель информации.
#### 11.12.2023
Мысли вслух, после ознакомления с ТЗ:
- Вот сюда сразу про 150dpi. Слабовато из-за мелкого шрифта в нижнем колонтитуле, откуда будет считываться номер страницы и номер бланка. Либо увеличиваем шрифт, либо плотность сканирования (dpi). Подсказывает опыт работы с FineReader.
- После исправления геометрических искажений информация на листе имеет небольшую погрешность позиционирования, но хуже всего, что в "шапке" бланка встречаются владельцы, не помещающиеся в одну строку и все содержимое на первых двух страницах съезжает вниз, а также вопросы, вынесенные на голосование, имеют разный размер. Из этого следует, что с фиксированных координат на листе можно считать только номер бюллетеня и нижний колонтитул. Результаты голосования считывать придется по маркерам (реперам). Как вариант, поиск, в качестве маркеров (реперов) использовать [ЗА], [ПРОТИВ], [ВОЗДЕРЖАЛСЯ]. Все по той же причине, нейросеть нужно будет натаскивать не на конкретный бланк из датасета, а на определенные данные в нем, т.е. необходимо добится результата, при котором количество вопросов при голосовании не будет иметь значения (считываются все найденные).
- Если считывается маркер (репер) вопроса, то по известному заранее смещению по координатам выполняется поиск отметок голосующих (исключаем дубликаты). Поставить галочку мимо клеточки - это прям как форма протеста какая-то и наша головная боль. Данные бланки летят в категорию "ИСПОРЧЕН". Устал и мысль закончилась...
#### 18.12.2023
Мысли вслух, после встречи с тимлидом:
- Перейти в TIFF формат, при извлечении листов из PDF не сложно, но нужно понимание необходимости многостраничных файлов в реализации проекта (с одностраничными то не все еще справляются, включая меня). Плюсы в меньшем количестве файлов. Имена файлов {номер бюллетеня}.tiff. Если многостраничные не поддержим, то {номер бюллетеня_номер страницы}.tiff. При любом раскладе, tiff выигрывает по размеру файлов.
- Реализация 1. Если заказчик берет на себя ответственность за раздельную подачу бюллетеней в сканер (все страницы по порядку бюллетеня 1, все страницы по порядку бюллетеня 2 и т.д.), то все проще. Потрошим PDF, предварительная обработка изображений, считывание номеров бюллетеней и колонтитулов страниц, переименование файлов (см. выше)
- Реализация 2. Если заказчик снимает с себя ответственность за качество подачи бюллетеней в сканер, то все усложняется. Сначала извлекаем лисы из PDF, затем предварительная обработка изображений. Считываем номера бюллетеней и колонтитулы страниц, переименовываем файлы (см. выше). Количество страниц бюллетеней нам предварительно известно из базы. Пробегаемся по именам файлов, проверяя соответствие количества страниц у каждого бюллетеня. Признаем недействительными бюллетени с количеством страниц, отличных от необходимого.
- Дополнительно, сверяем все номера бюллетеней с базой на предмет попадания номеров, отсутствующих в базе (бюллетени с отличными номерами признаются недействительными).
- Нужно ли реализовывать определение соответствия формы бюллетеня эталонной? Сложность в том, что из-за разных имен голосующих (у некоторых бюллетеней в датасете это название организациии-арендатора) плавает высота ячейки для заполнения. Вдобавок к этому, количество вопросов и их размер будет разным каждое голосование, что влияет на распололжение на бюллетене областей для считывания.
- Возвращаясь к проголосовавшим мимо специально отведенных ячеек (такие есть в датасете). Не понял, как это "человек старался, голосовал"? Как, например, вытащить отметку из окошка с [ЗА] или [ПРОТИВ]? Та еще задачка.
- Сдается, что после распознавания бюллетеней будет та еще сортировка результатов, но тут уже код не столь замороченный, хоть и длинный получится.
